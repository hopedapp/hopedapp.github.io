"use strict";(self.webpackChunkimtoken_dapp=self.webpackChunkimtoken_dapp||[]).push([[6504],{66416:(e,t,n)=>{n.d(t,{q:()=>i,N:()=>s});n(67294);var r=n(16550),o=n(93434),a=n(85893);function s(e){var t=e.navTitle,n=void 0===t?"":t,s=e.navFontSize,i=void 0===s?24:s,l=e.fontSize,c=void 0===l?18:l,d=e.titleColor,u=void 0===d?"#fff":d,p=(0,r.k6)();return(0,a.jsxs)("div",{className:"page-navbar__container",style:{color:u,fontSize:c},children:[(0,a.jsx)(o.Z,{style:{fontSize:i,marginLeft:"12px"},onClick:function(){return p.go(-1)}}),(0,a.jsx)("span",{className:"page-navbar__title",style:{color:u},children:n}),(0,a.jsx)("div",{className:"page-navbar__actions"})]})}function i(e){var t=(0,r.k6)(),n=e.navFontSize,s=void 0===n?24:n,i=e.fontSize,l=void 0===i?18:i,c=e.titleColor,d=void 0===c?"#fff":c;return(0,a.jsxs)("div",{className:"page-botbar__container",style:{color:d,fontSize:l},children:[(0,a.jsx)(o.Z,{style:{fontSize:s,marginLeft:"12px"},onClick:function(){return t.go(-1)}}),(0,a.jsx)("span",{className:"nav-title"}),(0,a.jsx)("div",{className:"page-botbar__actions"})]})}},89071:(e,t,n)=>{n.d(t,{Z:()=>re});var r=n(69798),o=n.n(r),a=n(14890),s=n(82100),i=n(16550),l=n(13535),c=n.n(l),d=n(56655),u=n(71649),p=n(68420),f=n(27344),h=n(84441),m=n(3020),v=n(3362),x=n(67294),b=n(79802),j=n(81516),_=n(5562),w=n(82240),k=n(95266),N=n(33938),y=n(63109),g=n.n(y),Z=n(30699),T=n.n(Z),S=n(37247),D=n.n(S),P=n(88066),I=n.n(P),R=n(89356),C=n.n(R),B=n(54579),L=n.n(B),M=n(50047),A=n.n(M),z=n(51005),E=n(58074),F=n(69039),V=n(3354),W=n(67126),H=n(70544),O=n(62576),q=n(57108),U=n(4141),$=n(44426),Q=n(85518),G=n(85893),X=n(25108),Y=function(){var e=(0,N.Z)(g().mark((function e(t){var n,r,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,e.prev=1,n){e.next=6;break}return e.next=5,(0,W.Nb)();case 5:n=e.sent;case 6:return e.next=8,(0,V.IO)(n);case 8:return r=e.sent,r=T()(r).call(r,(function(e){return"0"!==e})),o=(0,j.o1)(r,100),e.abrupt("return",{selectedAddress:n,ids:r,groups:o});case 14:throw e.prev=14,e.t0=e.catch(1),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();function J(e){var t=(0,i.k6)(),n=(0,s.I0)(),r=(0,s.v9)((function(e){return e.orderState})).orderList,a=void 0===r?[]:r,l=(0,s.v9)((function(e){return e.poolState.poolList})),c=(0,s.v9)((function(e){return e.dappState})),u=c.selectedAddress,p=(c.chainId,c.hasEthereum),f=(0,x.useState)(!1),h=(0,k.Z)(f,2),m=h[0],v=h[1],b=(0,x.useState)("Please use DApp in ImToken or Metamask mobile app"),y=(0,k.Z)(b,2),Z=y[0],T=y[1];function S(){return(S=(0,N.Z)(g().mark((function e(n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={pathname:(0,F.ZP)(F.k$,F._6),state:{orderId:n}},t.push(r);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,x.useEffect)((function(){p&&!u&&T("Not connected to the ethereum account, please refresh the DApp"),Y(u).then((function(e){var t=e.ids,r=D()(t).call(t,(function(e,t){return I()(e).call(e,[{orderId:t}])}),[]);return n((0,H.c)({orderIds:t,orderList:r})),e})).catch((function(e){X.log("Get Bill Ids Fail:>>>",e);var t=(0,q.e)(e);if(t===U.LU){var n=(0,W.dF)();T("Current network unsupport,please switch to ".concat(n)),v(!0)}else t===U.$S?(T("Please use DApp in ImToken or Metamask mobile app"),v(!0)):w.Z.show({icon:"fail",content:e.message,duration:4e3});return{}})).then((function(e){for(var t=e.groups,r=void 0===t?{}:t,a=C()(r).length,s=(0,O.rg)().methods.billDetails,i=function(e){var t=r[e],a=D()(t).call(t,(function(e,t){return I()(e).call(e,[s(t).call({from:u})])}),[]);if(0===e)o().all(a).then((function(e){var r=(0,V.Q5)({orderIds:t,billResults:e,poolList:l});n((0,H.g)(r))}));else{o().all(a).then((function(e){var r=(0,V.Q5)({orderIds:t,billResults:e,poolList:l});n((0,H.g)(r))}))}},c=0;c<a;c++)i(c)})).catch((function(e){X.log(">>>>>>>>>Load order detail fail>>>>>>",e)})),L()((function(){(0,V.uL)().then((function(e){n((0,$.Qd)(e))})).catch((function(e){X.log("Load order config fail:",e)}))}),2e3)}),[]),(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{className:"pl-order-title",children:(0,G.jsx)("div",{className:"inner-wrapper",children:(0,G.jsx)("span",{children:"Deposit Receipt"})})}),(0,G.jsx)("div",{className:"pl-order-container",children:m?(0,G.jsx)("div",{className:"pl-unsupport-wrapper",children:(0,G.jsx)(E.g,{iconFontSize:3,text:Z})}):(0,G.jsx)(_.Z,{style:{overflowY:"hidden"},children:A()(a).call(a,(function(e,t){return(0,G.jsx)(_.Z.Item,{className:"pl-order-item",children:(0,G.jsxs)(d.Z,{className:"pl-order__card",children:[(0,G.jsxs)("div",{className:"pl-order__card-head",children:[(0,G.jsxs)("div",{className:"pl-order__card-info",children:[(0,G.jsxs)("div",{className:"order-info-line",children:[(0,G.jsx)("span",{className:"pl-order__card-label",children:"No."}),(0,G.jsx)("span",{className:"pl-order__card-valt",children:e.orderId})]}),(0,G.jsxs)("div",{className:"order-info-line",children:[(0,G.jsx)("span",{className:"pl-order__card-label",children:"Date"}),(0,G.jsx)("span",{className:"pl-order__card-valt",children:e.createDate})]}),(0,G.jsxs)("div",{className:"order-info-line",children:[(0,G.jsx)("span",{className:"pl-order__card-label",children:"Pool address"}),(0,G.jsx)("span",{className:"pl-order__card-valt",children:(0,j.VE)(e.poolAddress,18)})]})]}),(0,G.jsxs)("div",{className:"pl-order__card-action",onClick:function(){!function(e){S.apply(this,arguments)}(e.orderId)},children:[(0,G.jsx)("div",{className:Q.tq?"pool-name is-mobile":"pool-name",children:(0,G.jsx)("span",{children:e.poolName})}),(0,G.jsx)(z.Z,{fontSize:"18"})]})]}),(0,G.jsx)("div",{className:"pl-order__card-foot",children:(0,G.jsx)("span",{className:"pl-order__card-valt pledge-amount",children:e.depositedValt})})]})},"pledge-"+t)}))})})]})}function K(e){var t=function(){if("undefined"==typeof Reflect||!c())return!1;if(c().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(c()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,v.Z)(e);if(t){var o=(0,v.Z)(this).constructor;n=c()(r,arguments,o)}else n=r.apply(this,arguments);return(0,m.Z)(this,n)}}var ee=function(e){(0,h.Z)(n,e);var t=K(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).state={tokenSymbol:"HOP",orders:(0,u.Z)(b.L),hasMore:!0},r}return(0,f.Z)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"renderHeader",value:function(){var e=this.props,t=e.isMobile,n=e.selectedAddress,r=e.hopBalance,o=this.state.tokenSymbol;return(0,G.jsx)("div",{className:"home-page__header",children:(0,G.jsxs)(d.Z,{className:t?"home-token-card is-mobile":"home-token-card",children:[(0,G.jsxs)("div",{className:"home-token-card__content",children:[(0,G.jsx)("h3",{className:"token-symbol",children:o}),(0,G.jsx)("p",{className:"token-address",children:n})]}),(0,G.jsx)("div",{className:"home-token-card__footer",children:(0,G.jsx)("span",{className:"token-hop-balance",children:r?(0,j.bc)(r,2):"-"})})]})})}},{key:"renderFooter",value:function(){return(0,G.jsx)("div",{className:"home-page__footer"})}},{key:"render",value:function(){var e=this.props,t=(e.hasEthereum,e.selectedAddress,e.isMobile),n=e.isBrowser,r=(0,j.Rt)("home-page",{isMobile:t,isBrowser:n});return(0,G.jsxs)("div",{className:r,children:[this.renderHeader(),(0,G.jsx)(J,{})]})}}]),n}(x.Component),te=n(59501),ne=n(25108);const re=(0,a.qC)(i.EN,(0,s.$j)((function(e){var t=e.skinState,n=t.isMobile,r=t.isBrowser,o=e.dappState,a=o.selectedAddress,s=void 0===a?"":a,i=o.hopBalance,l=o.hasEthereum;return{selectedAddress:s,isMobile:n,isBrowser:r,hopBalance:i,hasEthereum:void 0!==l&&l}}),(function(e){return{loadPoolList:function(){return function(e){return new(o())((function(e,t){O.j3.methods.getPoolList().call({},(function(n,r){return n?t(n):e(r)}))})).then((function(t){var n=poolIdsToPoolList(t);e({type:te.yw,val:n})})).catch((function(e){ne.warn(e)}))}}}})))(ee)},79673:(e,t,n)=>{n.d(t,{Z:()=>q});var r=n(14890),o=n(82100),a=n(16550),s=n(13535),i=n.n(s),l=n(56655),c=n(68420),d=n(27344),u=n(84441),p=n(3020),f=n(3362),h=n(98882),m=n.n(h),v=n(2790),x=n.n(v),b=n(67294),j=n(93434),_=n(81516),w=n(48168),k=n(93806),N=n(28195),y=n(82240),g=n(33938),Z=n(95266),T=n(21052),S=n.n(T),D=n(96019),P=n.n(D),I=n(63109),R=n.n(I),C=n(3354),B=n(67126),L=n(85893),M=n(25108),A=function(e){var t=(0,o.v9)((function(e){return e.dappState})),n=t.selectedAddress,r=t.txTimeoutSeconds,s=void 0===r?8:r,i=(0,a.k6)(),l=(0,b.useState)(!1),c=(0,Z.Z)(l,2),d=c[0],u=c[1],p=(0,b.useState)(!1),f=(0,Z.Z)(p,2),h=f[0],m=f[1],v=e.orderId,x=e.pledgeAmount,j=(e.tsSecond,e.reddemButtonEnable),_=void 0!==j&&j,w=e.expireDate,T=void 0===w?"":w;function D(){return(D=(0,g.Z)(R().mark((function e(){var t,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=3;break}throw new Error("Please use it in ImToken app");case 3:return m(!0),e.next=6,(0,C.Ge)(v,n);case 6:t=e.sent,delete window._isReDeemTxTimeouted,delete window._txReDeemPending,t.send({from:n}).on("transactionHash",(function(e){window._txReDeemPending=!0,y.Z.show({icon:"loading",content:(0,L.jsx)(z,{hash:e,txTimeoutSeconds:s}),duration:1e3*S()(s),afterClose:function(){m(!1),u(!1),!0===window._txReDeemPending&&(delete window._txReDeemPending,window._isReDeemTxTimeouted=!0,i.push("/index"))}})})).on("receipt",(function(e){(delete window._txReDeemPending,window._isReDeemTxTimeouted||(delete window._isReDeemTxTimeouted,y.Z.clear(),m(!1),u(!1)),e&&e.status&&e.events)&&(e.events.UserWithDraw&&window._isReDeemTxTimeouted,i.push("/index"))})).on("error",(function(e,t){delete window._isReDeemTxTimeouted,delete window._txReDeemPending,e&&4001===e.code?y.Z.show({icon:"fail",content:e.message||"fail.",duration:3e3,afterClose:function(){m(!1)}}):y.Z.show({icon:"fail",content:e&&e.message?e.message:"Fail.",duration:4e3,afterClose:function(){m(!1),u(!1)}})})),e.next=22;break;case 12:e.prev=12,e.t0=e.catch(0),delete window._isReDeemTxTimeouted,delete window._txReDeemPending,e.t0&&e.t0.code?e.t0.code:"",r=e.t0&&e.t0.message?e.t0.message:e.t0,M.warn("Withdraw Fail",e.t0),y.Z.show({icon:"fail",content:"Withdraw error:".concat(r),duration:3e3}),m(!1),u(!1);case 22:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(N.Z,{disabled:!1,color:"primary",size:"small",className:"brv-btn brv-btn-round",onClick:(0,g.Z)(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,B.Wf)();case 3:u(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),y.Z.show({icon:"fail",content:e.t0&&e.t0.message?e.t0.message:"Please use it in the ImToken app",duration:4e3});case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),style:{maxWidth:"600px"},children:"Withdraw"}),(0,L.jsxs)(k.Z,{visible:d,position:"bottom",onMaskClick:function(){return!h&&u(!1)},bodyClassName:"brv-popup__body",bodyStyle:{minHeight:"35vh",borderTopLeftRadius:"12px",borderTopRightRadius:"12px"},children:[(0,L.jsx)("div",{className:"brv-popup__title",children:(0,L.jsx)("span",{className:"popup-title order-no",children:v})}),(0,L.jsx)("div",{className:"brv-popup__content",children:(0,L.jsx)("p",{className:"popup-message",children:_?"This bill pre-profit ".concat(x," HOP"):T?"This bill due date: ".concat(T):""})}),(0,L.jsx)("div",{className:"brv-popup__bottom",children:(0,L.jsx)(N.Z,{disabled:h,color:"primary",size:"small",className:"brv-btn brv-btn-round",onClick:function(){return D.apply(this,arguments)},style:{maxWidth:"600px"},children:"Confirm"})})]})]})};function z(e){e.hash;var t=e.txTimeoutSeconds,n=void 0===t?8:t,r=(0,b.useState)(n),o=(0,Z.Z)(r,2),a=o[0],s=o[1];return(0,b.useEffect)((function(){var e=P()((function(){s((function(e){return e>1?e-1:e}))}),1e3);return function(){window.clearInterval(e)}}),[]),(0,L.jsxs)("p",{children:[(0,L.jsx)("span",{children:"Transaction packing. This will go back to list after"}),(0,L.jsx)("span",{style:{color:"#dc7548",paddingLeft:"0.2em",paddingRight:"0.2em"},children:a}),"seconds."]})}var E=n(41231);function F(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.Z)(e);if(t){var o=(0,f.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var V=function(e){(0,u.Z)(n,e);var t=F(n);function n(e){var r;return(0,c.Z)(this,n),(r=t.call(this,e)).state={orderId:"",createDay:"",dueDay:"",depositedValt:""},r}return(0,d.Z)(n,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this.props,t=e.location,n=e.orderList,r=void 0===n?[]:n,o=e.asynPreCheckTxState,a=t.state,s=void 0===a?{}:a;if(s.orderId){this.setState({orderId:s.orderId});var i=m()(r).call(r,(function(e){return e.orderId===s.orderId}));i&&this.setState(i)}o&&o()}},{key:"componentWillUnmount",value:function(){}},{key:"renderHeader",value:function(){var e=this.props,t=(e.isMobile,e.isBrowser),n=e.history;return t&&(0,L.jsxs)("div",{className:"plo-detail__header",children:[(0,L.jsx)(j.Z,{style:{fontSize:24,color:"#fff",marginLeft:"12px"},onClick:function(){return n.go(-1)}}),(0,L.jsx)("span",{className:"brv-nav-title",children:this.state.orderId}),(0,L.jsx)("div",{className:"plo-detail__header-actions"})]})}},{key:"renderContent",value:function(){var e=this.props,t=(e.location,e.isMobile),n=e.isImToken,r=(e.poolProfitRate,e.userProfitRate),o=this.state,a=o.orderId,s=(o.createDay,o.createDate),i=o.depositedWei,c=o.depositedValt,d=o.dueDay,u=o.expireDate,p=o.poolAddress,f=o.poolName,h=(o.profit,(0,C.CV)(i,r)),m=x()((0,E.kA)(c,h)).toFixed(4),v=(0,_.pT)(d),b=(0,_.Rt)("plo-detail__content",{isMobile:t,isImToken:n});return(0,L.jsx)("div",{className:b,children:(0,L.jsxs)(l.Z,{headerClassName:"brv-card-title",title:a,className:"brv-card",children:[(0,L.jsxs)("div",{className:"brv-form",children:[(0,L.jsx)(w.a,{labelBox:!0,labelText:"Balance",labelValue:c}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Deposit Date",labelValue:s}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Expired Date",labelValue:u}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Pool Name",labelValue:f}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Pool Address",labelValue:(0,_.VE)(p)}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Pre-Profit",labelValue:h})]}),(0,L.jsx)("div",{className:"brv-card__footer",children:(0,L.jsx)(A,{orderId:a,pledgeAmount:m,reddemButtonEnable:v,expireDate:u})})]})})}},{key:"renderFooter",value:function(){var e=this.props,t=e.history,n=e.isMobile;e.isImToken;return n&&(0,L.jsx)("div",{className:"plo-detail__footer",children:(0,L.jsx)(j.Z,{style:{fontSize:24,color:"#fff"},onClick:function(){return t.go(-1)}})})}},{key:"render",value:function(){return(0,L.jsxs)("div",{className:"plo-detail",children:[this.renderHeader(),this.renderContent(),this.renderFooter()]})}}]),n}(b.Component),W=n(27556),H=n(44426),O=n(25108);const q=(0,r.qC)(a.EN,(0,o.$j)((function(e){var t=e.skinState,n=t.isMobile,r=t.isBrowser,o=e.orderState,a=o.orderList,s=void 0===a?[]:a,i=(o.ethBalance,o.allowanceWei,o.poolProfitRate),l=void 0===i?1:i,c=o.userProfitRate;return{isMobile:n,orderList:s,isBrowser:r,poolProfitRate:l,userProfitRate:void 0===c?14:c}}),(function(e){return{asynPreCheckTxState:function(){(0,W.M)().then((function(t){e((0,H.X4)(t))})).catch((function(e){return O.log(e)}))}}})))(V)}}]);