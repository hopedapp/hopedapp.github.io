"use strict";(self.webpackChunkimtoken_dapp=self.webpackChunkimtoken_dapp||[]).push([[6504],{66416:(e,n,t)=>{t.d(n,{q:()=>i,N:()=>s});t(67294);var r=t(16550),o=t(93434),a=t(85893);function s(e){var n=e.navTitle,t=void 0===n?"":n,s=e.navFontSize,i=void 0===s?24:s,l=e.fontSize,c=void 0===l?18:l,d=e.titleColor,u=void 0===d?"#fff":d,p=(0,r.k6)();return(0,a.jsxs)("div",{className:"page-navbar__container",style:{color:u,fontSize:c},children:[(0,a.jsx)(o.Z,{style:{fontSize:i,marginLeft:"12px"},onClick:function(){return p.go(-1)}}),(0,a.jsx)("span",{className:"page-navbar__title",style:{color:u},children:t}),(0,a.jsx)("div",{className:"page-navbar__actions"})]})}function i(e){var n=(0,r.k6)(),t=e.navFontSize,s=void 0===t?24:t,i=e.fontSize,l=void 0===i?18:i,c=e.titleColor,d=void 0===c?"#fff":c;return(0,a.jsxs)("div",{className:"page-botbar__container",style:{color:d,fontSize:l},children:[(0,a.jsx)(o.Z,{style:{fontSize:s,marginLeft:"12px"},onClick:function(){return n.go(-1)}}),(0,a.jsx)("span",{className:"nav-title"}),(0,a.jsx)("div",{className:"page-botbar__actions"})]})}},89071:(e,n,t)=>{t.d(n,{Z:()=>re});var r=t(69798),o=t.n(r),a=t(14890),s=t(82100),i=t(16550),l=t(13535),c=t.n(l),d=t(56655),u=t(71649),p=t(68420),f=t(27344),h=t(84441),m=t(3020),v=t(3362),x=t(67294),b=t(79802),j=t(81516),_=t(5562),w=t(82240),k=t(95266),N=t(33938),g=t(63109),y=t.n(g),Z=t(30699),T=t.n(Z),S=t(37247),D=t.n(S),P=t(88066),I=t.n(P),R=t(89356),C=t.n(R),B=t(54579),L=t.n(B),M=t(50047),A=t.n(M),z=t(51005),E=t(58074),F=t(69039),V=t(3354),W=t(67126),H=t(70544),O=t(62576),q=t(57108),U=t(4141),$=t(44426),Q=t(85518),G=t(85893),X=t(25108),Y=function(){var e=(0,N.Z)(y().mark((function e(n){var t,r,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n,e.prev=1,t){e.next=6;break}return e.next=5,(0,W.Nb)();case 5:t=e.sent;case 6:return e.next=8,(0,V.IO)(t);case 8:return r=e.sent,r=T()(r).call(r,(function(e){return"0"!==e})),o=(0,j.o1)(r,100),e.abrupt("return",{selectedAddress:t,ids:r,groups:o});case 14:throw e.prev=14,e.t0=e.catch(1),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(n){return e.apply(this,arguments)}}();function J(e){var n=(0,i.k6)(),t=(0,s.I0)(),r=(0,s.v9)((function(e){return e.orderState})).orderList,a=void 0===r?[]:r,l=(0,s.v9)((function(e){return e.poolState.poolList})),c=(0,s.v9)((function(e){return e.dappState})),u=c.selectedAddress,p=(c.chainId,c.hasEthereum),f=(0,x.useState)(!1),h=(0,k.Z)(f,2),m=h[0],v=h[1],b=(0,x.useState)("Please use DApp in ImToken or Metamask mobile app"),g=(0,k.Z)(b,2),Z=g[0],T=g[1];function S(){return(S=(0,N.Z)(y().mark((function e(t){var r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={pathname:(0,F.ZP)(F.k$,F._6),state:{orderId:t}},n.push(r);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,x.useEffect)((function(){p&&!u&&T("Not connected to the ethereum account, please refresh the DApp"),Y(u).then((function(e){var n=e.ids,r=D()(n).call(n,(function(e,n){return I()(e).call(e,[{orderId:n}])}),[]);return t((0,H.c)({orderIds:n,orderList:r})),e})).catch((function(e){X.log("Get Bill Ids Fail:>>>",e);var n=(0,q.e)(e);if(n===U.LU){var t=(0,W.dF)();T("Current network unsupport,please switch to ".concat(t)),v(!0)}else n===U.$S?(T("Please use DApp in ImToken or Metamask mobile app"),v(!0)):w.Z.show({icon:"fail",content:e.message,duration:4e3});return{}})).then((function(e){for(var n=e.groups,r=void 0===n?{}:n,a=C()(r).length,s=(0,O.rg)().methods.billDetails,i=function(e){var n=r[e],a=D()(n).call(n,(function(e,n){return I()(e).call(e,[s(n).call({from:u})])}),[]);if(0===e)o().all(a).then((function(e){var r=(0,V.Q5)({orderIds:n,billResults:e,poolList:l});t((0,H.g)(r))}));else{o().all(a).then((function(e){var r=(0,V.Q5)({orderIds:n,billResults:e,poolList:l});t((0,H.g)(r))}))}},c=0;c<a;c++)i(c)})).catch((function(e){X.log(">>>>>>>>>Load order detail fail>>>>>>",e)})),L()((function(){(0,V.uL)().then((function(e){t((0,$.Qd)(e))})).catch((function(e){X.log("Load order config fail:",e)}))}),2e3)}),[]),(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{className:"pl-order-title",children:(0,G.jsx)("div",{className:"inner-wrapper",children:(0,G.jsx)("span",{children:"Deposit Receipt"})})}),(0,G.jsx)("div",{className:"pl-order-container",children:m?(0,G.jsx)("div",{className:"pl-unsupport-wrapper",children:(0,G.jsx)(E.g,{iconFontSize:3,text:Z})}):(0,G.jsx)(_.Z,{style:{overflowY:"hidden"},children:A()(a).call(a,(function(e,n){return(0,G.jsx)(_.Z.Item,{className:"pl-order-item",children:(0,G.jsxs)(d.Z,{className:"pl-order__card",children:[(0,G.jsxs)("div",{className:"pl-order__card-head",children:[(0,G.jsxs)("div",{className:"pl-order__card-info",children:[(0,G.jsxs)("div",{className:"order-info-line",children:[(0,G.jsx)("span",{className:"pl-order__card-label",children:"No."}),(0,G.jsx)("span",{className:"pl-order__card-valt",children:e.orderId})]}),(0,G.jsxs)("div",{className:"order-info-line",children:[(0,G.jsx)("span",{className:"pl-order__card-label",children:"Date"}),(0,G.jsx)("span",{className:"pl-order__card-valt",children:e.createDate})]}),(0,G.jsxs)("div",{className:"order-info-line",children:[(0,G.jsx)("span",{className:"pl-order__card-label",children:"Pool address"}),(0,G.jsx)("span",{className:"pl-order__card-valt",children:(0,j.VE)(e.poolAddress,18)})]})]}),(0,G.jsxs)("div",{className:"pl-order__card-action",onClick:function(){!function(e){S.apply(this,arguments)}(e.orderId)},children:[(0,G.jsx)("div",{className:Q.tq?"pool-name is-mobile":"pool-name",children:(0,G.jsx)("span",{children:e.poolName})}),(0,G.jsx)(z.Z,{fontSize:"18"})]})]}),(0,G.jsx)("div",{className:"pl-order__card-foot",children:(0,G.jsx)("span",{className:"pl-order__card-valt pledge-amount",children:e.depositedValt})})]})},"pledge-"+n)}))})})]})}function K(e){var n=function(){if("undefined"==typeof Reflect||!c())return!1;if(c().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(c()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,v.Z)(e);if(n){var o=(0,v.Z)(this).constructor;t=c()(r,arguments,o)}else t=r.apply(this,arguments);return(0,m.Z)(this,t)}}var ee=function(e){(0,h.Z)(t,e);var n=K(t);function t(e){var r;return(0,p.Z)(this,t),(r=n.call(this,e)).state={tokenSymbol:"HOP",orders:(0,u.Z)(b.L),hasMore:!0},r}return(0,f.Z)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"renderHeader",value:function(){var e=this.props,n=e.isMobile,t=e.selectedAddress,r=e.hopBalance,o=this.state.tokenSymbol;return(0,G.jsx)("div",{className:"home-page__header",children:(0,G.jsxs)(d.Z,{className:n?"home-token-card is-mobile":"home-token-card",children:[(0,G.jsxs)("div",{className:"home-token-card__content",children:[(0,G.jsx)("h3",{className:"token-symbol",children:o}),(0,G.jsx)("p",{className:"token-address",children:t})]}),(0,G.jsx)("div",{className:"home-token-card__footer",children:(0,G.jsx)("span",{className:"token-hop-balance",children:r?(0,j.bc)(r,2):"-"})})]})})}},{key:"renderFooter",value:function(){return(0,G.jsx)("div",{className:"home-page__footer"})}},{key:"render",value:function(){var e=this.props,n=(e.hasEthereum,e.selectedAddress,e.isMobile),t=e.isBrowser,r=(0,j.Rt)("home-page",{isMobile:n,isBrowser:t});return(0,G.jsxs)("div",{className:r,children:[this.renderHeader(),(0,G.jsx)(J,{})]})}}]),t}(x.Component),ne=t(59501),te=t(25108);const re=(0,a.qC)(i.EN,(0,s.$j)((function(e){var n=e.skinState,t=n.isMobile,r=n.isBrowser,o=e.dappState,a=o.selectedAddress,s=void 0===a?"":a,i=o.hopBalance,l=o.hasEthereum;return{selectedAddress:s,isMobile:t,isBrowser:r,hopBalance:i,hasEthereum:void 0!==l&&l}}),(function(e){return{loadPoolList:function(){return function(e){return new(o())((function(e,n){O.j3.methods.getPoolList().call({},(function(t,r){return t?n(t):e(r)}))})).then((function(n){var t=poolIdsToPoolList(n);e({type:ne.yw,val:t})})).catch((function(e){te.warn(e)}))}}}})))(ee)},79673:(e,n,t)=>{t.d(n,{Z:()=>q});var r=t(14890),o=t(82100),a=t(16550),s=t(13535),i=t.n(s),l=t(56655),c=t(68420),d=t(27344),u=t(84441),p=t(3020),f=t(3362),h=t(98882),m=t.n(h),v=t(2790),x=t.n(v),b=t(67294),j=t(93434),_=t(81516),w=t(48168),k=t(93806),N=t(28195),g=t(82240),y=t(33938),Z=t(95266),T=t(21052),S=t.n(T),D=t(96019),P=t.n(D),I=t(63109),R=t.n(I),C=t(3354),B=t(67126),L=t(85893),M=t(25108),A=function(e){var n=(0,o.v9)((function(e){return e.dappState})),t=n.selectedAddress,r=n.txTimeoutSeconds,s=void 0===r?8:r,i=(0,a.k6)(),l=(0,b.useState)(!1),c=(0,Z.Z)(l,2),d=c[0],u=c[1],p=(0,b.useState)(!1),f=(0,Z.Z)(p,2),h=f[0],m=f[1],v=e.orderId,x=e.pledgeAmount;e.tsSecond,e.reddemButtonEnable;function j(){return(j=(0,y.Z)(R().mark((function e(){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}throw new Error("Please use it in ImToken app");case 3:return m(!0),e.next=6,(0,C.Ge)(v,t);case 6:n=e.sent,delete window._isReDeemTxTimeouted,delete window._txReDeemPending,n.send({from:t}).on("transactionHash",(function(e){window._txReDeemPending=!0,g.Z.show({icon:"loading",content:(0,L.jsx)(z,{hash:e,txTimeoutSeconds:s}),duration:1e3*S()(s),afterClose:function(){m(!1),u(!1),!0===window._txReDeemPending&&(delete window._txReDeemPending,window._isReDeemTxTimeouted=!0,i.push("/index"))}})})).on("receipt",(function(e){(delete window._txReDeemPending,window._isReDeemTxTimeouted||(delete window._isReDeemTxTimeouted,g.Z.clear(),m(!1),u(!1)),e&&e.status&&e.events)&&(e.events.UserWithDraw&&window._isReDeemTxTimeouted,i.push("/index"))})).on("error",(function(e,n){delete window._isReDeemTxTimeouted,delete window._txReDeemPending,M.log("redeem fail:>>>",e),e&&4001===e.code?g.Z.show({icon:"fail",content:e.message||"fail.",duration:3e3,afterClose:function(){m(!1)}}):g.Z.show({icon:"fail",content:e&&e.message?e.message:"Fail.",duration:4e3,afterClose:function(){m(!1),u(!1)}})})),e.next=22;break;case 12:e.prev=12,e.t0=e.catch(0),delete window._isReDeemTxTimeouted,delete window._txReDeemPending,e.t0&&e.t0.code?e.t0.code:"",r=e.t0&&e.t0.message?e.t0.message:e.t0,M.warn("Withdraw Fail",e.t0),g.Z.show({icon:"fail",content:"Withdraw error:".concat(r),duration:3e3}),m(!1),u(!1);case 22:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(N.Z,{disabled:!1,color:"primary",size:"small",className:"brv-btn brv-btn-round",onClick:(0,y.Z)(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,B.Wf)();case 3:u(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),g.Z.show({icon:"fail",content:e.t0&&e.t0.message?e.t0.message:"Please use it in the ImToken app",duration:4e3});case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),style:{maxWidth:"600px"},children:"Withdraw"}),(0,L.jsxs)(k.Z,{visible:d,position:"bottom",onMaskClick:function(){return!h&&u(!1)},bodyClassName:"brv-popup__body",bodyStyle:{minHeight:"35vh",borderTopLeftRadius:"12px",borderTopRightRadius:"12px"},children:[(0,L.jsx)("div",{className:"brv-popup__title",children:(0,L.jsx)("span",{className:"popup-title order-no",children:v})}),(0,L.jsx)("div",{className:"brv-popup__content",children:(0,L.jsxs)("p",{className:"popup-message",children:["This bill pre-profit ",x," HOP"]})}),(0,L.jsx)("div",{className:"brv-popup__bottom",children:(0,L.jsx)(N.Z,{disabled:h,color:"primary",size:"small",className:"brv-btn brv-btn-round",onClick:function(){return j.apply(this,arguments)},style:{maxWidth:"600px"},children:"Confirm"})})]})]})};function z(e){e.hash;var n=e.txTimeoutSeconds,t=void 0===n?8:n,r=(0,b.useState)(t),o=(0,Z.Z)(r,2),a=o[0],s=o[1];return(0,b.useEffect)((function(){var e=P()((function(){s((function(e){return e>1?e-1:e}))}),1e3);return function(){window.clearInterval(e)}}),[]),(0,L.jsxs)("p",{children:[(0,L.jsx)("span",{children:"Transaction packing. This will go back to list after"}),(0,L.jsx)("span",{style:{color:"#dc7548",paddingLeft:"0.2em",paddingRight:"0.2em"},children:a}),"seconds."]})}var E=t(41231);function F(e){var n=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,f.Z)(e);if(n){var o=(0,f.Z)(this).constructor;t=i()(r,arguments,o)}else t=r.apply(this,arguments);return(0,p.Z)(this,t)}}var V=function(e){(0,u.Z)(t,e);var n=F(t);function t(e){var r;return(0,c.Z)(this,t),(r=n.call(this,e)).state={orderId:"",createDay:"",dueDay:"",depositedValt:""},r}return(0,d.Z)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this.props,n=e.location,t=e.orderList,r=void 0===t?[]:t,o=e.asynPreCheckTxState,a=n.state,s=void 0===a?{}:a;if(s.orderId){this.setState({orderId:s.orderId});var i=m()(r).call(r,(function(e){return e.orderId===s.orderId}));i&&this.setState(i)}o&&o()}},{key:"componentWillUnmount",value:function(){}},{key:"renderHeader",value:function(){var e=this.props,n=(e.isMobile,e.isBrowser),t=e.history;return n&&(0,L.jsxs)("div",{className:"plo-detail__header",children:[(0,L.jsx)(j.Z,{style:{fontSize:24,color:"#fff",marginLeft:"12px"},onClick:function(){return t.go(-1)}}),(0,L.jsx)("span",{className:"brv-nav-title",children:this.state.orderId}),(0,L.jsx)("div",{className:"plo-detail__header-actions"})]})}},{key:"renderContent",value:function(){var e=this.props,n=(e.location,e.isMobile),t=e.isImToken,r=(e.poolProfitRate,e.userProfitRate),o=this.state,a=o.orderId,s=(o.createDay,o.createDate),i=o.depositedWei,c=o.depositedValt,d=o.dueDay,u=o.expireDate,p=o.poolAddress,f=o.poolName,h=(o.profit,(0,C.CV)(i,r)),m=x()((0,E.kA)(c,h)).toFixed(4),v=(0,_.pT)(d),b=(0,_.Rt)("plo-detail__content",{isMobile:n,isImToken:t});return(0,L.jsx)("div",{className:b,children:(0,L.jsxs)(l.Z,{headerClassName:"brv-card-title",title:a,className:"brv-card",children:[(0,L.jsxs)("div",{className:"brv-form",children:[(0,L.jsx)(w.a,{labelBox:!0,labelText:"Balance",labelValue:c}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Deposit Date",labelValue:s}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Expired Date",labelValue:u}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Pool Name",labelValue:f}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Pool Address",labelValue:(0,_.VE)(p)}),(0,L.jsx)(w.a,{labelBox:!0,labelText:"Pre-Profit",labelValue:h})]}),(0,L.jsx)("div",{className:"brv-card__footer",children:(0,L.jsx)(A,{orderId:a,pledgeAmount:m,reddemButtonEnable:v})})]})})}},{key:"renderFooter",value:function(){var e=this.props,n=e.history,t=e.isMobile;e.isImToken;return t&&(0,L.jsx)("div",{className:"plo-detail__footer",children:(0,L.jsx)(j.Z,{style:{fontSize:24,color:"#fff"},onClick:function(){return n.go(-1)}})})}},{key:"render",value:function(){return(0,L.jsxs)("div",{className:"plo-detail",children:[this.renderHeader(),this.renderContent(),this.renderFooter()]})}}]),t}(b.Component),W=t(27556),H=t(44426),O=t(25108);const q=(0,r.qC)(a.EN,(0,o.$j)((function(e){var n=e.skinState,t=n.isMobile,r=n.isBrowser,o=e.orderState,a=o.orderList,s=void 0===a?[]:a,i=(o.ethBalance,o.allowanceWei,o.poolProfitRate),l=void 0===i?1:i,c=o.userProfitRate;return{isMobile:t,orderList:s,isBrowser:r,poolProfitRate:l,userProfitRate:void 0===c?14:c}}),(function(e){return{asynPreCheckTxState:function(){(0,W.M)().then((function(n){e((0,H.X4)(n))})).catch((function(e){return O.log(e)}))}}})))(V)}}]);